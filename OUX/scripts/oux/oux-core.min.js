"use strict";var OUX;(function(n){function r(n){return n===undefined?!0:n===null?!0:n===NaN?!0:n==={}?!0:n===[]?!0:String(n).trim().length===0?!0:!1}function t(n,t){return t===void 0&&(t=undefined),r(n)?t:n}function i(n,i,r){var u,f;return i===void 0&&(i=""),r===void 0&&(r=[]),u=angular.lowercase(String(n)).trim(),r.length>0&&(f=!1,angular.forEach(r,function(n){angular.lowercase(n).trim()===u&&(f=!0)}),f||(u=undefined)),t(u,angular.lowercase(i).trim())}var u,o,f,e,s;n.IsBlank=r;n.IfBlank=t;n.Option=i,function(n){var t=function(){function n(){}return Object.defineProperty(n,"viewFormat",{get:function(){return moment.localeData().longDateFormat("L")},enumerable:!0,configurable:!0}),Object.defineProperty(n,"modelFormat",{get:function(){return"YYYY-MM-DD"},enumerable:!0,configurable:!0}),n.Parser=function(t){var r=undefined;switch(i(t)){case"today":r=moment();break;case"yesterday":r=moment().subtract(1,"days");break;case"tomorrow":r=moment().add(1,"days");break;default:r=moment(t,n.viewFormat)}return r.isValid()?r.format(n.modelFormat):undefined},n.Formatter=function(t){var i=moment(String(t).substr(0,10),n.modelFormat);return i.isValid()?i.format(n.viewFormat):undefined},n}();n.Date=t}(u=n.Convert||(n.Convert={})),function(n){function f(){var n=function(){return{restrict:"E",scope:!1,controller:i,controllerAs:"oux"}};return n.$inject=["$log"],n}var i=function(){function n(n,i,f,e,o){var s=this;this.$scope=n;this.$routeParams=i;this.$parse=f;this.$window=e;this.$log=o;this.procedures={};this.addProcedure=function(n){s.procedures[n.alias]=n;s.$log.debug('OUX procedure "'+n.alias+'" added to context')};this.removeProcedure=function(n){delete s.procedures[n.alias];s.$log.debug('OUX procedure "'+n.alias+'" removed from context')};this.parameterValue=function(n){var i=undefined;switch(n.type){case"route":i=s.$routeParams[n.value];break;case"scope":i=s.$parse(n.value)(s.$scope);break;default:i=n.value}if(r(i))return null;switch(n.format){case"date":i=u.Date.Parser(u.Date.Formatter(i));break;case"object":i=angular.fromJson(angular.toJson(i));break;default:i=String(i)}return t(i,null)};this.execute=function(n){var i=s.procedures[n],r={token:t(s.$window.localStorage.getItem("token")),procedure:{name:i.name,parameters:[]}};angular.forEach(i.parameters,function(n){r.procedure.parameters.push({name:n.name,value:s.parameterValue(n),isObject:n.format==="object"})});s.$log.debug('OUX execute procedure "'+i.alias+'"');s.$log.debug(r)};o.debug('OUX context instantiated on page "'+e.location+'"')}return n.$inject=["$scope","$routeParams","$parse","$window","$log"],n}();n.Controller=i;n.DirectiveFactory=f}(o=n.Context||(n.Context={})),function(n){function u(){return{restrict:"E",scope:{name:"@",alias:"@",run:"@",routeParams:"@"},controller:r,require:["^^oux","ouxProcedure"],link:function(n,t,i,r){r[0].addProcedure(r[1]);n.$on("$destroy",function(){r[0].removeProcedure(r[1])});r[1].run!=="manual"&&r[0].execute(r[1].alias);r[1].run==="auto"&&n.$watchCollection(function(){return r[1].parameters},function(n,t){n!==t&&r[0].execute(r[1].alias)})}}}var r=function(){function n(n,t,r){var u=this;this.$scope=n;this.$log=r;this.parameters={};this.addParameter=function(n){u.parameters[n.name]=n;u.$log.debug('OUX parameter "'+n.name+'" added to procedure "'+u.alias+'"')};this.removeParameter=function(n){delete u.parameters[n.name];u.$log.debug('OUX parameter "'+n.name+'" removed from procedure "'+u.alias+'"')};i(n.routeParams)==="true"&&angular.forEach(t,function(t,i){u.addParameter(new e.Controller(angular.extend(n.$new(!0),{name:i,type:"route"})))})}return Object.defineProperty(n.prototype,"name",{get:function(){return t(this.$scope.name)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"alias",{get:function(){return t(this.$scope.alias,this.name)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"run",{get:function(){return i(this.$scope.run,"manual",["once","auto"])},enumerable:!0,configurable:!0}),n.$inject=["$scope","$routeParams","$log"],n}();n.Controller=r;n.Directive=u}(f=n.Procedure||(n.Procedure={})),function(n){function u(){return{restrict:"E",scope:{name:"@",type:"@",value:"@",format:"@",required:"@"},controller:r,require:["^^oux","^^ouxProcedure","ouxParameter"],link:function(n,t,i,r){r[1].addParameter(r[2]);n.$on("$destroy",function(){r[1].removeParameter(r[2])});r[1].run==="auto"&&n.$watch(function(){return r[0].parameterValue(r[2])},function(n,t){n!==t&&r[0].execute(r[1].alias)})}}}var r=function(){function n(n){this.$scope=n}return Object.defineProperty(n.prototype,"name",{get:function(){return t(this.$scope.name)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return i(this.$scope.type,"value",["route","scope"])},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return t(this.$scope.value,this.type==="route"?this.name:undefined)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"format",{get:function(){return i(this.$scope.format)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"required",{get:function(){return i(this.$scope.required)==="true"},enumerable:!0,configurable:!0}),n.$inject=["$scope"],n}();n.Controller=r;n.Directive=u}(e=n.Parameter||(n.Parameter={})),function(n){function u(){var n=function(n){return{restrict:"E",templateUrl:"ouxForm.html",transclude:!0,scope:{heading:"@",load:"@",save:"@","delete":"@"},controller:i,controllerAs:"ouxForm",require:["^^oux","ouxForm"],link:function(t,i,r,u){function e(i){var r=i.split(" as ",2),o=r[0],e=r.length>1?r[1]:r[0];angular.isUndefined(u[0].procedures[e])&&u[0].addProcedure(n.instantiate(f.Controller,{$scope:angular.extend(t.$new(!0),{name:o,alias:e,routeParams:"true"})}))}u[1].loadable&&(e(t.load),u[1].load=function(){u[0].execute(u[1].loadProcAlias)},u[1].load());u[1].editable&&(e(t.save),u[1].save=function(){u[0].execute(u[1].saveProcAlias)});u[1].deletable&&(e(t.delete),u[1].delete=function(){u[0].execute(u[1].deleteProcAlias)})}}};return n.$inject=["$injector"],n}var i=function(){function n(n,t){var i=this;this.$scope=n;this.$route=t;this.load=undefined;this.save=undefined;this.delete=undefined;this.undo=function(){i.$route.reload()}}return Object.defineProperty(n.prototype,"loadable",{get:function(){return!r(this.$scope.load)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"loadProcName",{get:function(){return this.$scope.load.split(" as ",2)[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"loadProcAlias",{get:function(){return this.$scope.load.split(" as ",2)[1]||this.loadProcName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"editable",{get:function(){return!r(this.$scope.save)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"saveProcName",{get:function(){return this.$scope.save.split(" as ",2)[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"saveProcAlias",{get:function(){return this.$scope.save.split(" as ",2)[1]||this.saveProcName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"deletable",{get:function(){return!r(this.$scope.delete)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"deleteProcName",{get:function(){return this.$scope.delete.split(" as ",2)[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"deleteProcAlias",{get:function(){return this.$scope.delete.split(" as ",2)[1]||this.deleteProcName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"heading",{get:function(){return t(this.$scope.heading)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dirty",{get:function(){return this.$scope.form.$dirty},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"invalid",{get:function(){return this.$scope.form.$invalid},enumerable:!0,configurable:!0}),n.$inject=["$scope","$route"],n}();n.Controller=i;n.DirectiveFactory=u}(s=n.Form||(n.Form={}))})(OUX||(OUX={}));define(["moment","angular","angular-locale","angular-route"],function(n,t){var i=t.module("oux",["ngRoute"]);return i.run(["$locale","$log",function(t,i){n.locale(t.id);i.info({locale:t.id,dateFormat:n.localeData().longDateFormat("L"),currencySymbol:t.NUMBER_FORMATS.CURRENCY_SYM,decimalSeparator:t.NUMBER_FORMATS.DECIMAL_SEP,groupSeparator:t.NUMBER_FORMATS.GROUP_SEP})}]),i.directive("oux",OUX.Context.DirectiveFactory()),i.directive("ouxProcedure",OUX.Procedure.Directive),i.directive("ouxParameter",OUX.Parameter.Directive),i.directive("ouxForm",OUX.Form.DirectiveFactory()),i});
//# sourceMappingURL=oux-core.min.js.map
